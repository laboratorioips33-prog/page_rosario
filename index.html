<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yo Te Facturo</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
</head>
<body>

    <div class="container">
        <header>
            <h1><i class="fas fa-file-invoice-dollar"></i> Yo Te Facturo</h1>
            <p>Gestiona tus facturas, extrae datos fiscales y administra tus emisores.</p>
        </header>

        <div class="main-nav">
            <button class="nav-btn active" onclick="switchView('tools')">
                <i class="fas fa-tools"></i> Herramientas
            </button>
            <button class="nav-btn" onclick="switchView('account')">
                <i class="fas fa-user-circle"></i> Mi Cuenta
            </button>
        </div>

        <div id="view-tools" class="main-view active">
            <div class="card">
                <div class="card-header"><i class="fas fa-file-pdf"></i> <h2>Extractor de Datos</h2></div>
                <div class="card-body">
                    <p class="text-center text-muted">Utiliza esta herramienta para extraer datos de constancias fiscales.</p>
                    <button class="btn w-100" id="selectFileBtn">Seleccionar PDF</button>
                    <input type="file" id="fileInput" class="hidden">
                </div>
            </div>
        </div>

        <div id="view-account" class="main-view hidden">
            
            <div id="login-screen" class="card text-center" style="max-width: 400px; margin: 0 auto;">
                <div class="card-header bg-secondary">
                    <i class="fas fa-sign-in-alt"></i> <h2>Iniciar Sesión</h2>
                </div>
                <div class="card-body">
                    <p>Accede para ver tus facturas y configuraciones.</p>
                    <button class="btn btn-google w-100" onclick="loginWithGoogle()">
                        <i class="fab fa-google"></i> Continuar con Google
                    </button>
                </div>
            </div>

            <div id="link-screen" class="card text-center hidden" style="max-width: 500px; margin: 0 auto;">
                <div class="card-header">
                    <i class="fas fa-link"></i> <h2>Vincular WhatsApp</h2>
                </div>
                <div class="card-body">
                    <p>Hola <span id="userNameSpan"></span>. Para ver tus datos, necesitamos conectar tu WhatsApp.</p>
                    <p class="small text-muted">Ve al Bot > Menú Admin > Opción 6 e ingresa este código:</p>
                    
                    <div class="code-box" id="codeDisplay">
                        <span id="generatedCode">Cargando...</span>
                    </div>
                    <div id="pollingSpinner" class="spinner hidden"></div>
                </div>
            </div>

            <div id="dashboard-screen" class="hidden">
                <div class="dashboard-header">
                    <h3>Hola, <span id="dashUserName">Usuario</span></h3>
                    <button class="btn btn-sm btn-danger" onclick="logout()">Salir</button>
                </div>
                
                <div class="dashboard-tabs">
                    <button class="dash-tab active" onclick="openDashTab('tabFacturas')">Facturas</button>
                    <button class="dash-tab" onclick="openDashTab('tabEmisores')">Emisores</button>
                </div>

                <div id="tabFacturas" class="dash-content active">
                    <div class="card">
                        <div class="card-body table-responsive">
                            <table class="table" id="tableFacturas">
                                <thead><tr><th>Folio</th><th>Receptor</th><th>Total</th><th>Estado</th><th>PDF</th></tr></thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div id="tabEmisores" class="dash-content">
                    <div class="card">
                        <div class="card-body table-responsive">
                            <table class="table" id="tableEmisores">
                                <thead><tr><th>RFC</th><th>Nombre</th><th>Acción</th></tr></thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>
